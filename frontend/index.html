<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Git Repository Health Analyzer</title>

<style>
body{
  font-family: Inter, Arial, sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  margin:0;
}

.container{
  max-width:900px;
  margin:auto;
  padding:60px 20px;
}

h1{
  font-size:34px;
  margin-bottom:10px;
}

.subtitle{
  color:#94a3b8;
  margin-bottom:40px;
}

input{
  width:100%;
  padding:14px;
  border-radius:8px;
  border:none;
  font-size:16px;
}

button{
  margin-top:14px;
  padding:12px 22px;
  background:#2563eb;
  border:none;
  border-radius:8px;
  color:white;
  font-size:16px;
  cursor:pointer;
}

button.secondary{
  background:#334155;
  margin-left:10px;
}

button:hover{
  background:#1d4ed8;
}

.section{
  margin-top:70px;
}

.section h2{
  margin-bottom:25px;
  border-bottom:1px solid #1e293b;
  padding-bottom:10px;
}

.metric{
  margin-bottom:25px;
}

.metric-title{
  display:flex;
  justify-content:space-between;
  font-size:16px;
}

.bar-bg{
  background:#020617;
  height:10px;
  border-radius:10px;
  overflow:hidden;
  margin-top:8px;
}

.bar-fill{
  height:10px;
  background:#22c55e;
}

.good{color:#22c55e;}
.warn{color:#facc15;}
.bad{color:#ef4444;}

.loading{
  margin-top:20px;
  color:#93c5fd;
}
</style>
</head>

<body>

<div class="container">

<h1>Git Repository Health Analyzer</h1>
<p class="subtitle">Analyze engineering health of any public GitHub repository</p>

<input id="repo" placeholder="https://github.com/org/repo"/>

<div>
  <button onclick="analyze()">Analyze</button>
  <button class="secondary" onclick="clearUI()">Clear</button>
</div>

<div id="loading" class="loading"></div>

<div id="results"></div>

</div>

<script>

function scoreFromStatus(status){
  if(["Healthy","Low Risk","Present","Good"].includes(status)) return 100;
  if(["Moderate","Acceptable","Weak"].includes(status)) return 70;
  return 30;
}

function colorClass(status){
  if(["Healthy","Low Risk","Present","Good"].includes(status)) return "good";
  if(["Moderate","Acceptable","Weak"].includes(status)) return "warn";
  return "bad";
}

function clearUI(){
  document.getElementById("repo").value="";
  document.getElementById("loading").innerText="";
  document.getElementById("results").innerHTML="";
}

async function analyze(){

  const repo=document.getElementById("repo").value;
  const loading=document.getElementById("loading");
  const results=document.getElementById("results");

  loading.innerText="Analyzing repository...";
  results.innerHTML="";

  try{
    const res=await fetch("/analyze",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({repo_url:repo})
    });

    const data=await res.json();
    loading.innerText="";

    results.innerHTML=`
    <div class="section">
      <h2>Overall Health</h2>
      <h3>${data.health_score} / 100 â€” ${data.status}</h3>
    </div>

    <div class="section">
      <h2>Metrics</h2>

      ${renderMetric("Commit Activity",data.metrics.commit_activity)}
      ${renderMetric("Contributor Diversity",data.metrics.contributors)}
      ${renderMetric("Pull Request Hygiene",data.metrics.pull_request_hygiene)}
      ${renderMetric("CI/CD",data.metrics.ci_cd)}
      ${renderMetric("Documentation",data.metrics.documentation)}

    </div>
    `;

  }catch(e){
    loading.innerText="Invalid repository or server error";
  }
}

function renderMetric(name,status){

  const score=scoreFromStatus(status);

  return `
  <div class="metric">
    <div class="metric-title">
      <span>${name}</span>
      <span class="${colorClass(status)}">${status}</span>
    </div>
    <div class="bar-bg">
      <div class="bar-fill" style="width:${score}%"></div>
    </div>
  </div>
  `;
}

</script>

</body>
</html>
